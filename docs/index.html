<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AndroidX latest release notes</title>
  <style>
    /* See this website for inspiration: https://platformstatus.io/ */

    @import url('https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@400;700&family=Roboto:wght@400;700&display=swap');

    * {
      --heading-padding: 16px;
    }

    h1, h2, strong {
        font-family: "Roboto Slab", serif;
    }

    p, li {
        font-family: "Roboto", sans-serif;
        font-size: 15px;
    }

    h2 {
        display: inline-block;
        background: #b1e1f7;
        border: 1px solid;
        border-radius: 50px;
        padding-inline: var(--heading-padding);
        margin: 0;
        margin-block-start: 48px;
    }

    /* The date element */
    h2 + p {
      margin-block-start: 8px;
      margin-block-end: 4px;
      margin-inline-start: var(--heading-padding);
      font-size: 12px;
    }

    strong {
        background: #e0fdb5;
        border: 1px solid;
        border-radius: 50px;
        padding-inline: 16px;
        margin-inline-start: 24px;
    }

    pre {
      background: #eee;
      padding-block: 4px;
      padding-inline: 8px;
    }
  </style>
</head>
<body>

<a href="https://github.com/mahozad/androidx-release-notes" style="position: absolute; inset-block-start: 16px; inset-inline-end: 8px;">
  <svg width="48" viewBox="0 0 32.579 31.775" xmlns="http://www.w3.org/2000/svg">
    <path fill="#1b1817" d="m16.288 0c-8.995 0-16.288 7.293-16.288 16.29 0 7.197 4.667 13.302 11.14 15.457 0.815 0.149 1.112-0.354 1.112-0.786 0-0.386-0.014-1.411-0.022-2.77-4.531 0.984-5.487-2.184-5.487-2.184-0.741-1.881-1.809-2.382-1.809-2.382-1.479-1.011 0.112-0.991 0.112-0.991 1.635 0.116 2.495 1.679 2.495 1.679 1.453 2.489 3.813 1.77 4.741 1.354 0.148-1.053 0.568-1.771 1.034-2.178-3.617-0.411-7.42-1.809-7.42-8.051 0-1.778 0.635-3.232 1.677-4.371-0.168-0.412-0.727-2.068 0.159-4.311 0 0 1.368-0.438 4.48 1.67 1.299-0.361 2.693-0.542 4.078-0.548 1.383 6e-3 2.777 0.187 4.078 0.548 3.11-2.108 4.475-1.67 4.475-1.67 0.889 2.243 0.33 3.899 0.162 4.311 1.044 1.139 1.675 2.593 1.675 4.371 0 6.258-3.809 7.635-7.438 8.038 0.585 0.503 1.106 1.497 1.106 3.017 0 2.177-0.02 3.934-0.02 4.468 0 0.436 0.293 0.943 1.12 0.784 6.468-2.159 11.131-8.26 11.131-15.455 0-8.997-7.294-16.29-16.291-16.29"/>
  </svg>
</a>

<h1>Latest update</h1>
<hr>
<base href="https://developer.android.com/" target="_blank"/>

<h2>Media3: v1.4.0-alpha01</h2>
<p>April 17, 2024</p>
<p><code translate="no" dir="ltr">androidx.media3:media3-*:1.4.0-alpha01</code> is released. Version 1.4.0-alpha01 contains <a href="https://github.com/androidx/media/commits/1.4.0-alpha01">these commits</a>.</p>
<ul>
 <li>ExoPlayer: 
  <ul>
   <li>Add <code translate="no" dir="ltr">BasePreloadManager</code> which coordinates the preloading for multiple sources based on the priorities defined by their <code translate="no" dir="ltr">rankingData</code>. Customization is possible by extending this class. Add <code translate="no" dir="ltr">DefaultPreloadManager</code> which uses <code translate="no" dir="ltr">PreloadMediaSource</code> to preload media samples of the sources into memory, and uses an integer <code translate="no" dir="ltr">rankingData</code> that indicates the index of an item on the UI.</li>
   <li>Add <code translate="no" dir="ltr">PlayerId</code> to most methods of <code translate="no" dir="ltr">LoadControl</code> to enable <code translate="no" dir="ltr">LoadControl</code> implementations to support multiple players.</li>
   <li>Remove <code translate="no" dir="ltr">Buffer.isDecodeOnly()</code> and <code translate="no" dir="ltr">C.BUFFER_FLAG_DECODE_ONLY</code>. There is no need to set this flag as renderers and decoders will decide to skip buffers based on timestamp. Custom <code translate="no" dir="ltr">Renderer</code> implementations should check if the buffer time is at least <code translate="no" dir="ltr">BaseRenderer.getLastResetPositionUs()</code> to decide whether a sample should be shown. Custom <code translate="no" dir="ltr">SimpleDecoder</code> implementations can check <code translate="no" dir="ltr">isAtLeastOutputStartTimeUs</code> if needed or mark other buffers with <code translate="no" dir="ltr">DecoderOutputBuffer.shouldBeSkipped</code> to skip them.</li>
   <li>Allow a null value to be returned by <code translate="no" dir="ltr">TargetPreloadStatusControl.getTargetPreloadStatus(T)</code> to indicate not to preload a <code translate="no" dir="ltr">MediaSource</code> with the given <code translate="no" dir="ltr">rankingData</code>.</li>
   <li>Add <code translate="no" dir="ltr">remove(MediaSource)</code> to <code translate="no" dir="ltr">BasePreloadManager</code>.</li>
  </ul></li>
 <li>Transformer: 
  <ul>
   <li>Add <code translate="no" dir="ltr">audioConversionProcess</code> and <code translate="no" dir="ltr">videoConversionProcess</code> to <code translate="no" dir="ltr">ExportResult</code> indicating how the respective track in the output file was made.</li>
   <li>Relax trim optimization H.264 level checks.</li>
   <li>Add support for changing between SDR and HDR input media in a sequence.</li>
   <li>Add support for composition-level audio effects.</li>
   <li>Add support for transcoding Ultra HDR images into HDR videos.</li>
   <li>Fix issue where the <code translate="no" dir="ltr">DefaultAudioMixer</code> does not output the correct amount of bytes after being reset and reused.</li>
  </ul></li>
 <li>Video: 
  <ul>
   <li>Fix issue where <code translate="no" dir="ltr">Listener.onRenderedFirstFrame()</code> arrives too early when switching surfaces mid-playback.</li>
  </ul></li>
 <li>DataSource: 
  <ul>
   <li>Implement support for <code translate="no" dir="ltr">android.resource://package/id</code> raw resource URIs where <code translate="no" dir="ltr">package</code> is different to the package of the current application. This wasn't previously documented to work, but is a more efficient way of accessing resources in another package than by name.</li>
   <li>Eagerly check <code translate="no" dir="ltr">url</code> is non-null in the <code translate="no" dir="ltr">DataSpec</code> constructors. This parameter was already annotated to be non-null.</li>
  </ul></li>
 <li>Effect: 
  <ul>
   <li>Support multiple speed changes within the same <code translate="no" dir="ltr">EditedMediaItem</code> or <code translate="no" dir="ltr">Composition</code> in <code translate="no" dir="ltr">SpeedChangeEffect</code>.</li>
   <li>Support for HLG and PQ output from ultra HDR bitmap input.</li>
   <li>Add support for EGL_GL_COLORSPACE_BT2020_HLG_EXT, which improves HLG surface output in ExoPlayer.setVideoEffect and Transformer's Debug SurfaceView.</li>
   <li>Update Overlay matrix implementation to make it consistent with the documentation by flipping the x and y values applied in <code translate="no" dir="ltr">setOverlayFrameAnchor()</code>. If using <code translate="no" dir="ltr">OverlaySettings.Builder.setOverlayFrameAnchor()</code>, flip their x and y values by multiplying them by <code translate="no" dir="ltr">-1</code>.</li>
  </ul></li>
 <li>Session: 
  <ul>
   <li>Change default of <code translate="no" dir="ltr">CommandButton.enabled</code> to <code translate="no" dir="ltr">true</code> and ensure the value can stay false for controllers even if the associated command is available.</li>
   <li>Add icon constants for <code translate="no" dir="ltr">CommandButton</code> that should be used instead of custom icon resources.</li>
   <li>Add <code translate="no" dir="ltr">MediaSessionService.isPlaybackOngoing()</code> to let apps query whether the service needs to be stopped in <code translate="no" dir="ltr">onTaskRemoved()</code> (<a href="https://github.com/androidx/media/issues/1219">#1219</a>).</li>
   <li>Add <code translate="no" dir="ltr">MediaSessionService.pauseAllPlayersAndStopSelf()</code> that conveniently allows to pause playback of all sessions and call <code translate="no" dir="ltr">stopSelf</code> to terminate the lifecycle of the <code translate="no" dir="ltr">MediaSessionService</code>.</li>
   <li>Override <code translate="no" dir="ltr">MediaSessionService.onTaskRemoved(Intent)</code> to provide a safe default implementation that keeps the service running in the foreground if playback is ongoing or stops the service otherwise.</li>
  </ul></li>
 <li>Downloads: 
  <ul>
   <li>Ensure that <code translate="no" dir="ltr">DownloadHelper</code> does not leak unreleased <code translate="no" dir="ltr">Renderer</code> instances, which can eventually result in an app crashing with <code translate="no" dir="ltr">IllegalStateException: Too many receivers, total of 1000, registered for pid</code> (<a href="https://github.com/androidx/media/issues/1224">#1224</a>).</li>
  </ul></li>
 <li>Test Utilities: 
  <ul>
   <li>Implement <code translate="no" dir="ltr">onInit()</code> and <code translate="no" dir="ltr">onRelease()</code> in <code translate="no" dir="ltr">FakeRenderer</code>.</li>
   <li>Change <code translate="no" dir="ltr">TestPlayerRunHelper.runUntil/playUntil</code> methods to fail on nonfatal errors (e.g. those reported to <code translate="no" dir="ltr">AnalyticsListener.onVideoCodecError</code>). Use the new <code translate="no" dir="ltr">TestPlayerRunHelper.run(player).ignoringNonFatalErrors().untilXXX()</code> method chain to disable this behavior.</li>
  </ul></li>
 <li>Demo app: 
  <ul>
   <li>Use <code translate="no" dir="ltr">DefaultPreloadManager</code> in the short form demo app.</li>
  </ul></li>
 <li>Remove deprecated symbols: 
  <ul>
   <li>Remove <code translate="no" dir="ltr">CronetDataSourceFactory</code>. Use <code translate="no" dir="ltr">CronetDataSource.Factory</code> instead.</li>
   <li>Remove some <code translate="no" dir="ltr">DataSpec</code> constructors. Use <code translate="no" dir="ltr">DataSpec.Builder</code> instead.</li>
  </ul></li>
</ul>
</body>
</html>
